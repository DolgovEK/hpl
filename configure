#!/bin/bash

cat > common.mk << 'endmsg'

#############################################################
#    This file was automatically generated by configure     #
# Please modify its contents according to your installation #
#############################################################

# Compiler to use
CXX := c++

# OpenCL compilation flags (should not be needed)
OPENCLFLAGS := 

# Library required to link with OpenCL
endmsg

os=`uname -s`

if [ "$os" = "Darwin" ]; then
	echo OPENCLLIBS := -framework OpenCL >> common.mk
else
	echo OPENCLLIBS := -lOpenCL >> common.mk
fi

cat >> common.mk << 'endmsg'

#Set home directory of clBLAS if you have it
CLBLAS_DIR :=

# Compilation flags
ifdef PRODUCTION
  CPPFLAGS := -O3 -DNDEBUG -fno-rtti
else
  CPPFLAGS := -g 
  ifdef DEBUG
    CPPFLAGS += -DDEBUG
  endif
endif

ifdef HPL_PROFILE
	CPPFLAGS += -DHPL_PROFILE
endif

CPPFLAGS += -std=c++0x -Wno-deprecated-declarations

##################################################
# YOU SHOULD NOT MODIFY ANYTHING BELOW THIS LINE #
##################################################

endmsg

echo HPL_HOME := $PWD >> common.mk

cat >> common.mk << 'endmsg'

DEPDIR := .deps

PETEDIR := $(HPL_HOME)/lib/pete-2.1.0

CPPFLAGS += -I. -I$(HPL_HOME)/src $(OPENCLFLAGS)

PROJECTLIBNAME := libHPL.a

PROJECTLIB := $(HPL_HOME)/lib/$(PROJECTLIBNAME)

endmsg
